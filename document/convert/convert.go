//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package convert ;import (_g "bytes";_d "github.com/unidoc/unioffice/common/tempstorage";_c "github.com/unidoc/unioffice/document";_f "github.com/unidoc/unioffice/measurement";_bd "github.com/unidoc/unioffice/schema/soo/dml";_dd "github.com/unidoc/unioffice/schema/soo/dml/picture";_ega "github.com/unidoc/unioffice/schema/soo/ofc/sharedTypes";_ae "github.com/unidoc/unioffice/schema/soo/wml";_gf "github.com/unidoc/unipdf/v3/creator";_eg "github.com/unidoc/unipdf/v3/model";_ad "io/ioutil";_a "log";_b "strconv";_bc "strings";);const _ef =6;func (_gbgc *convertContext )makeRunStyle (_gcae *_ae .CT_RPr ,_fcae ,_adcb ,_aefa bool )(_gf .TextStyle ,bool ,bool ){_feac :=_gbgc ._fag .NewTextStyle ();if _gcae !=nil {_fdeg :=_gf .ColorBlack ;_dfcf :=4.25;_dagb :=0;_accc :="\u0064e\u0066\u0061\u0075\u006c\u0074";_bfeg :=0.0;if _gcae .Color !=nil {_bgag :=_gcae .Color .ValAttr .ST_HexColorRGB ;if _bgag !=nil {_fdeg =_gf .ColorRGBFromHex ("\u0023"+*_bgag );};};if _aefa {_fgf ,_cfcf ,_dba :=_fdeg .ToRGB ();_fgf ,_cfcf ,_dba =_ecgbe (_fgf ),_ecgbe (_cfcf ),_ecgbe (_dba );_fdeg =_gf .ColorRGBFromArithmetic (_fgf ,_cfcf ,_dba );};if _abba :=_gcae .Spacing ;_abba !=nil {_bfeg =_eaff (*_abba .ValAttr .Int64 );};var _efeg float64 ;if _gfaf :=_gcae .Sz ;_gfaf !=nil {_efeg =float64 (*_gfaf .ValAttr .ST_UnsignedDecimalNumber );}else if _aaff :=_gcae .SzCs ;_aaff !=nil {_efeg =float64 (*_aaff .ValAttr .ST_UnsignedDecimalNumber );};if _efeg !=0{_dfcf =_efeg /24*4.25;};_adcc :=_gcae .B !=nil ||_gcae .BCs !=nil ;_fbf :=_gcae .I !=nil ||_gcae .ICs !=nil ;if _adcc &&_fbf {_dagb =3;}else if _adcc {_dagb =1;}else if _fbf {_dagb =2;};if _aedc :=_gcae .RFonts ;_aedc !=nil {if _cegd :=_aedc .AsciiAttr ;_cegd !=nil {_accc =*_cegd ;}else if _fegd :=_aedc .HAnsiAttr ;_fegd !=nil {_accc =*_fegd ;};};if _adcba :=_gcae .VertAlign ;_adcba !=nil {_aafe :=_adcba .ValAttr ;_fcae =_aafe ==_ega .ST_VerticalAlignRunSuperscript ;_adcb =_aafe ==_ega .ST_VerticalAlignRunSubscript ;};_feac .Color =_fdeg ;if _dfcf > _gbgc ._bceb {_gbgc ._bceb =_dfcf ;};if _fcae ||_adcb {_dfcf *=0.64;};if _aefa {if _fcae {_feac .TextRise =1.5;};if _adcb {_feac .TextRise =-1.5;};};_feac .FontSize =_dfcf ;_feac .CharSpacing =_bfeg ;_aeec ,_cgef :=_bffg [_accc ];if !_cgef {_aeec =_bffg ["\u0064e\u0066\u0061\u0075\u006c\u0074"];};_beaac :=_eg .StdFontName (_aeec [_dagb ]);_feac .Font =_eg .NewStandard14FontMustCompile (_beaac );};return _feac ,_fcae ,_adcb ;};type textbox struct{_gab *_gf .Block ;_adcd float64 ;_gfaa float64 ;_cfb bool ;_egf float64 ;_ggc _gf .Color ;};func (_afd *convertContext )adjustRightBoundOfLastSpan (){_ddcd :=_afd ._gcfa ._aed ;_abc :=_afd ._bgfc ._gfa +_afd ._caa ._dc ;_bcf :=_abc +_afd ._bgfc ._ge ;for _ ,_bbag :=range _afd ._ebf ._egd {if ((_abc > _bbag ._ba ._ag &&_abc < _bbag ._ba ._fg )||(_bcf > _bbag ._ba ._ag &&_abc < _bbag ._ba ._fg ))&&(_ddcd > _bbag ._ba ._cc ){_ddcd =_bbag ._ba ._cc ;};};_afd ._gcfa ._aed =_ddcd ;};func (_eba *convertContext )addInlineBlock (_dabb *symbol ){if len (_eba ._eaf ._fda )> 0{_ccdg :=_eba ._eaf ._fda [len (_eba ._eaf ._fda )-1]._baf ;if _ccdg =="\u0020"{_eba .addCurrentWordToParagraph ();_eba .newWord ();};};_eba ._eaf ._fda =append (_eba ._eaf ._fda ,_dabb );_dabb ._acf =_eba ._eaf ._afc ;_eba ._eaf ._afc +=_dabb ._gac ;_eba ._eaf ._cfg =false ;if _eba ._bgfc ._ge < _dabb ._bdc {_eba ._caa ._de +=(_dabb ._bdc -_eba ._bgfc ._ge );_eba ._bgfc ._ge =_dabb ._bdc ;};};func (_gead *convertContext )makePdfBlockFromGraphics (_dcge *_bd .Graphic )(*textbox ,error ){if _fbg :=_dcge .GraphicData ;_fbg !=nil {for _ ,_cebf :=range _fbg .Any {if _dcda ,_aadb :=_cebf .(*_ae .WdWsp );_aadb {if _gaff :=_dcda .WChoice ;_gaff !=nil {if _adaf :=_gaff .Txbx ;_adaf !=nil {if _gdga :=_adaf .TxbxContent ;_gdga !=nil {if _acgd :=_gdga .EG_ContentBlockContent ;len (_acgd )> 0{if _dggcc :=_dcda .SpPr ;_dggcc !=nil {if _bbeac :=_dggcc .Xfrm ;_bbeac !=nil {if _gag :=_bbeac .Ext ;_gag !=nil {_geag :=_f .FromEMU (_gag .CxAttr )/_f .Millimeter ;_afee :=_f .FromEMU (_gag .CyAttr )/_f .Millimeter ;_eadb :=&rectangle {_ag :_beaa ,_fg :_beaa ,_cc :_beaa ,_ac :_beaa };_gcccc ,_fdgb :=_gead .makePdfBlockFromCBCs ([][]*_ae .EG_ContentBlockContent {_acgd },_geag ,_afee ,_eadb ,false ,"");if _fdgb !=nil {return nil ,_fdgb ;};var _edea bool ;var _dgab float64 ;var _daa _gf .Color ;if _fgb :=_dggcc .PrstGeom ;_fgb !=nil {if _fgb .PrstAttr ==_bd .ST_ShapeTypeRect {if _edcd :=_dggcc .Ln ;_edcd !=nil {if _cfec :=_edcd .WAttr ;_cfec !=nil {_edea =true ;_dgab =_f .FromEMU (int64 (*_cfec ))/_f .Millimeter ;_daa =_gf .ColorBlack ;if _fdca :=_edcd .SolidFill ;_fdca !=nil {if _fadc :=_fdca .SrgbClr ;_fadc !=nil {_daa =_gf .ColorRGBFromHex ("\u0023"+_fadc .ValAttr );};};};};};};_age :=&textbox {_gab :_gcccc ,_cfb :_edea ,_egf :_dgab ,_ggc :_daa };return _age ,nil ;};};};};};};};};};};return nil ,nil ;};func (_gbfc *convertContext )addEmptyLine (){_gbfc .addTextSymbol (&symbol {_baf :"\u000d",_gac :0})};func _bff (_cdee int ,_caed bool )string {_cfd :=(_cdee -1)/26+1;_bebd :=byte ((_cdee -1)%26);if _caed {_bebd +=byte (65);}else {_bebd +=byte (97);};_cdfb :=_g .NewBuffer ([]byte {});for _aedg :=0;_aedg < _cfd ;_aedg ++{_cdfb .Write ([]byte {_bebd });};return _cdfb .String ();};func (_beb *convertContext )newWord (){_beb ._eaf =&word {_cfg :true ,_eda :_beb ._bgfc ._edg }};func (_gbff *convertContext )newSpan (){_adbc :=&span {_agg :_gbff ._bgfc ._edg ,_aed :_gbff ._bgfc ._gg };_gbff ._gcfa =_adbc ;_gbff ._bgfc ._agac =append (_gbff ._bgfc ._agac ,_adbc );};func _fgbc (_bbdc ,_acab *_ae .CT_Border ,_faae bool )*_ae .CT_Border {if _faae {return _bbdc ;};return _acab ;};func (_afeg *convertContext )addEndnotes (){for _eff ,_egdg :=range _afeg ._bbdeg {if _eff ==0{_afeg .addSeparator ();};_afeg ._gfde =_egdg ._dg ;for _ggfa ,_aeaba :=range _egdg ._ff {if _eff !=0||_ggfa !=0{_afeg ._bbb =true ;};_afeg .addAbsoluteCBCs (_aeaba .EG_ContentBlockContent );};};_afeg ._bbb =false ;};func _efaff (_aaddgg int ,_ggea bool )string {_dcdf :=_g .NewBuffer ([]byte {});for _ ,_cdfe :=range _fgcf {for {if _aaddgg < _cdfe ._ebd {break ;};_dcdf .WriteString (_cdfe ._effb );_aaddgg -=_cdfe ._ebd ;};};_gbeb :=_dcdf .String ();if _ggea {_gbeb =_bc .ToUpper (_gbeb );};return _gbeb ;};func (_cfbe *convertContext )addInlineTextbox (_dabba *_ae .CT_Drawing ,_adfd *_ae .CT_RPr ){for _ ,_fgcd :=range _dabba .Inline {if _dcaf :=_fgcd .Graphic ;_dcaf !=nil {_cccd ,_dfba :=_cfbe .makePdfBlockFromGraphics (_dcaf );if _dfba !=nil {_a .Println ("C\u0061n\u006e\u006f\u0074\u0020\u0072\u0065\u0061\u0064 \u0074\u0065\u0078\u0074bo\u0078\u003a",_dfba );};if _cccd ==nil {return ;};_bdeb :=_fgcd .Extent ;if _bdeb ==nil {return ;};_feeg :=_f .FromEMU (_bdeb .CxAttr )/_f .Millimeter ;_dfd :=_f .FromEMU (_bdeb .CyAttr )/_f .Millimeter ;_cccd ._gab .Scale (_feeg /_cccd ._gab .Width (),_dfd /_cccd ._gab .Height ());_cfbe .addInlineBlock (&symbol {_bdc :_dfd ,_gac :_feeg ,_eb :_cccd });};};};func (_dga *convertContext )alignSymbolsVertically (){for _ ,_dfa :=range _dga ._agbb {for _ ,_dfe :=range _dfa ._cd {for _ ,_cbe :=range _dfe ._cdd {_be :=0.0;for _ ,_fdg :=range _cbe ._agac {for _ ,_aegd :=range _fdg ._adc {for _ ,_bafa :=range _aegd ._fda {if _bafa ._bdc > _be {_be =_bafa ._bdc ;};};};};for _ ,_bf :=range _cbe ._agac {for _ ,_ggcf :=range _bf ._adc {for _ ,_fgdf :=range _ggcf ._fda {if _fgdf ._bdc < _be {_fgdf ._df =_be -_fgdf ._bdc ;};};};};};};};};var _bffg =map[string ][]string {"\u0048e\u006c\u0076\u0065\u0074\u0069\u0063a":[]string {"\u0048e\u006c\u0076\u0065\u0074\u0069\u0063a","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061-\u0042\u006f\u006c\u0064","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061\u002d\u004f\u0062l\u0069\u0071\u0075\u0065","H\u0065\u006c\u0076\u0065ti\u0063a\u002d\u0042\u006f\u006c\u0064O\u0062\u006c\u0069\u0071\u0075\u0065"},"\u0043o\u0075\u0072\u0069\u0065\u0072":[]string {"\u0043o\u0075\u0072\u0069\u0065\u0072","\u0043\u006f\u0075r\u0069\u0065\u0072\u002d\u0042\u006f\u006c\u0064","\u0043o\u0075r\u0069\u0065\u0072\u002d\u004f\u0062\u006c\u0069\u0071\u0075\u0065","\u0043\u006f\u0075\u0072ie\u0072\u002d\u0042\u006f\u006c\u0064\u004f\u0062\u006c\u0069\u0071\u0075\u0065"},"\u0054i\u006de\u0073\u0020\u004e\u0065\u0077\u0020\u0052\u006f\u006d\u0061\u006e":[]string {"T\u0069\u006d\u0065\u0073\u002d\u0052\u006f\u006d\u0061\u006e","\u0054\u0069\u006d\u0065\u0073\u002d\u0042\u006f\u006c\u0064","\u0054\u0069\u006de\u0073\u002d\u0049\u0074\u0061\u006c\u0069\u0063","\u0054\u0069m\u0065\u0073\u002dB\u006f\u006c\u0064\u0049\u0074\u0061\u006c\u0069\u0063"},"\u0064e\u0066\u0061\u0075\u006c\u0074":[]string {"\u0048e\u006c\u0076\u0065\u0074\u0069\u0063a","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061-\u0042\u006f\u006c\u0064","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061\u002d\u004f\u0062l\u0069\u0071\u0075\u0065","H\u0065\u006c\u0076\u0065ti\u0063a\u002d\u0042\u006f\u006c\u0064O\u0062\u006c\u0069\u0071\u0075\u0065"}};func _cbg (_ada *_gf .Creator ,_agc *textbox ){_agc ._gab .SetPos (_agc ._adcd ,_agc ._gfaa );_ada .Draw (_agc ._gab );if _agc ._cfb {_bga :=_agc ._adcd ;_dcg :=_agc ._adcd +_agc ._gab .Width ();_ffb :=_agc ._gfaa ;_gbe :=_agc ._gfaa +_agc ._gab .Height ();_afg (_ada ,_bga ,_ffb ,_dcg ,_ffb ,_agc ._egf ,_agc ._ggc );_afg (_ada ,_bga ,_ffb ,_bga ,_gbe ,_agc ._egf ,_agc ._ggc );_afg (_ada ,_bga ,_gbe ,_dcg ,_gbe ,_agc ._egf ,_agc ._ggc );_afg (_ada ,_dcg ,_ffb ,_dcg ,_gbe ,_agc ._egf ,_agc ._ggc );};};func (_eabb *convertContext )addTextSymbol (_ccd *symbol ){_eaae :=_gf .New ();_gda :=_eaae .NewStyledParagraph ();_gda .SetMargins (0,0,0,0);_fdb :=_gda .Append (_ccd ._baf );_gda .SetLineHeight (_eabb ._caa ._cb );_efg :=0.0;if _ccd ._agbc !=nil {_fdb .Style =*_ccd ._agbc ;if _ccd ._agbc .CharSpacing !=0{_efg =_ccd ._agbc .CharSpacing ;};};_ccd ._bdc =_gda .Height ();_ccd ._gac =_gda .Width ()+_efg ;if len (_eabb ._eaf ._fda )> 0{_ddcg :=_eabb ._eaf ._fda [len (_eabb ._eaf ._fda )-1]._baf ;if (_ddcg =="\u0020")!=(_ccd ._baf =="\u0020"){_eabb .addCurrentWordToParagraph ();_eabb .newWord ();};};_eabb ._eaf ._fda =append (_eabb ._eaf ._fda ,_ccd );_ccd ._acf =_eabb ._eaf ._afc ;_eabb ._eaf ._afc +=_ccd ._gac ;if _ccd ._baf !="\u0020"{_eabb ._eaf ._cfg =false ;};if _ccd ._baf =="\u000d"{_eabb .adjustHeights (_ccd ._bdc );};};func _dfgb (_dfc int64 ,_fcdd _ae .ST_NumberFormat )string {_cebcg :=int (_dfc );switch _fcdd {case _ae .ST_NumberFormatDecimal :return _b .Itoa (_cebcg );case _ae .ST_NumberFormatUpperRoman :return _efaff (_cebcg ,true );case _ae .ST_NumberFormatLowerRoman :return _efaff (_cebcg ,false );case _ae .ST_NumberFormatUpperLetter :return _bff (_cebcg ,true );case _ae .ST_NumberFormatLowerLetter :return _bff (_cebcg ,false );default:return _b .Itoa (_cebcg );};};type symbol struct{_baf string ;_acf float64 ;_bdc float64 ;_df float64 ;_gac float64 ;_agbc *_gf .TextStyle ;_ffd *_gf .Image ;_eb *textbox ;_ea string ;_gea bool ;_dec bool ;};func (_eag *convertContext )addParagraphImages (_cae []*_ae .EG_PContent ){for _ ,_ceb :=range _cae {for _ ,_bea :=range _ceb .EG_ContentRunContent {if _bce :=_bea .R ;_bce !=nil {for _ ,_abe :=range _bce .EG_RunInnerContent {if _feb :=_abe .Drawing ;_feb !=nil {for _ ,_eca :=range _feb .Anchor {var _bagc ,_cddd ,_ebg ,_dee float64 ;_gfgb ,_aeab :=_eca .PositionH ,_eca .PositionV ;if _gfd :=_gfgb .Choice ;_gfd !=nil {if _gfd .PosOffset !=nil {_bagc =_f .FromEMU (int64 (*_gfd .PosOffset ))/_f .Millimeter ;};};if _edd :=_aeab .Choice ;_edd !=nil {if _edd .PosOffset !=nil {_cddd =_f .FromEMU (int64 (*_edd .PosOffset ))/_f .Millimeter ;};};if _cgc :=_eca .Extent ;_cgc !=nil {_dee =_f .FromEMU (_cgc .CxAttr )/_f .Millimeter ;_ebg =_f .FromEMU (_cgc .CyAttr )/_f .Millimeter ;};_adag :=_eag ._caa ._dc +_cddd ;_ccc :=_adag +_ebg ;_cfgb :=_eag ._caa ._ed +_bagc ;_gbfce :=_cfgb +_dee ;_gafg :=_cddd +_ebg ;if _gafg > _eag ._caa ._aga {_eag ._caa ._aga =_gafg ;};if _eca .Choice !=nil &&_eca .Choice .WrapNone ==nil {_eag ._caa ._bcd =append (_eag ._caa ._bcd ,&zoneToSkip {_ba :&rectangle {_ag :_adag ,_fg :_ccc ,_cc :_cfgb ,_ac :_gbfce },_cg :_eca .Choice });};if _bbf :=_eca .Graphic ;_bbf !=nil {_fcf ,_bbfe :=_eag .makePdfImageFromGraphics (_bbf );if _bbfe !=nil {_a .Println ("\u0043a\u006en\u006f\u0074\u0020\u0072\u0065a\u0064\u0020i\u006d\u0061\u0067\u0065\u003a",_bbfe );};if _fcf !=nil {_fcf .Scale (_dee /_fcf .Width (),_ebg /_fcf .Height ());_fcf .SetPos (_cfgb ,_adag );if _eca .BehindDocAttr {_eag ._caa ._gc =append (_eag ._caa ._gc ,_fcf );}else {_eag ._caa ._bac =append (_eag ._caa ._bac ,_fcf );};};};};};};};};};};type convertContext struct{_fag *_gf .Creator ;_cea *_c .Document ;_ecdg *_gf .StyledParagraph ;_agbb []*page ;_ebf *page ;_bcbb *rectangle ;_caa *paragraph ;_edge *rectangle ;_bgfc *line ;_gcfa *span ;_eaf *word ;_egcg *_ae .CT_Hyperlink ;_gabg *_ae .CT_ParaRPr ;_bbdeg []note ;_gfde string ;_fgad bool ;_cdg bool ;_fagb bool ;_ggdb float64 ;_bfa float64 ;_bfe float64 ;_bceb float64 ;_bbb bool ;};var _fgcf =[]romanMatch {romanMatch {1000,"\u006d"},romanMatch {900,"\u0063\u006d"},romanMatch {500,"\u0064"},romanMatch {400,"\u0063\u0064"},romanMatch {100,"\u0063"},romanMatch {90,"\u0078\u0063"},romanMatch {50,"\u006c"},romanMatch {40,"\u0078\u006c"},romanMatch {10,"\u0078"},romanMatch {9,"\u0069\u0078"},romanMatch {5,"\u0076"},romanMatch {4,"\u0069\u0076"},romanMatch {1,"\u0069"}};func _fcbe (_bdcg *_ae .CT_TblPr ,_acfc *_ae .CT_TcPr ,_afcbe ,_eebg ,_cfff ,_bfgg int )*_ae .CT_TcPr {if _acfc ==nil {_acfc =_ae .NewCT_TcPr ();};if _acfc .TcBorders ==nil {if _cgae :=_bdcg .TblBorders ;_cgae !=nil {_acfc .TcBorders =_ae .NewCT_TcBorders ();_acfc .TcBorders .Top =_fgbc (_cgae .Top ,_cgae .InsideH ,_afcbe ==0);_acfc .TcBorders .Bottom =_fgbc (_cgae .Bottom ,_cgae .InsideH ,_afcbe ==_cfff -1);_acfc .TcBorders .Left =_fgbc (_cgae .Left ,_cgae .InsideV ,_eebg ==0);_acfc .TcBorders .Right =_fgbc (_cgae .Right ,_cgae .InsideV ,_eebg ==_bfgg -1);};}else {if _bggg :=_bdcg .TblBorders ;_bggg !=nil {if _acfc .TcBorders .Top ==nil {_acfc .TcBorders .Top =_fgbc (_bggg .Top ,_bggg .InsideH ,_afcbe ==0);};if _acfc .TcBorders .Bottom ==nil {_acfc .TcBorders .Bottom =_fgbc (_bggg .Bottom ,_bggg .InsideH ,_afcbe ==_cfff -1);};if _acfc .TcBorders .Left ==nil {_acfc .TcBorders .Left =_fgbc (_bggg .Left ,_bggg .InsideV ,_eebg ==0);};if _acfc .TcBorders .Right ==nil {_acfc .TcBorders .Right =_fgbc (_bggg .Right ,_bggg .InsideV ,_eebg ==_bfgg -1);};};};if _acfc .Shd ==nil {if _bfaf :=_bdcg .Shd ;_bfaf !=nil {_acfc .Shd =_bfaf ;};}else {if _bdcg .Shd !=nil &&_acfc .Shd .FillAttr ==nil {_acfc .Shd .FillAttr =_bdcg .Shd .FillAttr ;};};if _acfc .TcMar ==nil {if _dcc :=_bdcg .TblCellMar ;_dcc !=nil {_acfc .TcMar =_ae .NewCT_TcMar ();_acfc .TcMar .Left =_dcc .Left ;};}else {if _bdcg .TblCellMar !=nil &&_acfc .TcMar .Left ==nil {_acfc .TcMar .Left =_bdcg .TblCellMar .Left ;};};return _acfc ;};const _beaa =2.5;type romanMatch struct{_ebd int ;_effb string ;};type page struct{_fff *rectangle ;_cd []*paragraph ;_acg float64 ;_egd []*zoneToSkip ;_fc []*_gf .Image ;_db []*_gf .Image ;_fd []*textbox ;_cf []*textbox ;_fe []*note ;_agf bool ;};func _eeaa (_cbee *_c .Document ,_abf *_ae .CT_RPr ,_debb *_ae .CT_ParaRPr )*_ae .CT_RPr {var _bbdgg ,_gcac *_ae .CT_RPr ;if _abf ==nil {_abf =_ae .NewCT_RPr ();};if _debb ==nil {_debb =_ae .NewCT_ParaRPr ();};if _abf .RStyle !=nil {_bcfa :=_cbee .GetStyleByID (_abf .RStyle .ValAttr );if _fcfg :=_bcfa .X ();_fcfg !=nil {_bbdgg =_fcfg .RPr ;};};if _bbdgg ==nil {_bbdgg =_ae .NewCT_RPr ();};if _debb .RStyle !=nil {_dcbb :=_cbee .GetStyleByID (_debb .RStyle .ValAttr );if _fgcc :=_dcbb .X ();_fgcc !=nil {_gcac =_fgcc .RPr ;};};if _gcac ==nil {_gcac =_ae .NewCT_RPr ();};if _abf .Color ==nil {if _bbdgg .Color !=nil {_abf .Color =_bbdgg .Color ;}else if _debb .Color !=nil {_abf .Color =_debb .Color ;}else if _gcac .Color !=nil {_abf .Color =_gcac .Color ;};};if _abf .Spacing ==nil {if _bbdgg .Spacing !=nil {_abf .Spacing =_bbdgg .Spacing ;}else if _debb .Spacing !=nil {_abf .Spacing =_debb .Spacing ;}else if _gcac .Spacing !=nil {_abf .Spacing =_gcac .Spacing ;};};if _abf .Sz ==nil {if _bbdgg .Sz !=nil {_abf .Sz =_bbdgg .Sz ;}else if _debb .Sz !=nil {_abf .Sz =_debb .Sz ;}else if _gcac .Sz !=nil {_abf .Sz =_gcac .Sz ;};};if _abf .SzCs ==nil {if _bbdgg .SzCs !=nil {_abf .SzCs =_bbdgg .SzCs ;}else if _debb .SzCs !=nil {_abf .SzCs =_debb .SzCs ;}else if _gcac .SzCs !=nil {_abf .SzCs =_gcac .SzCs ;};};if _abf .B ==nil {if _bbdgg .B !=nil {_abf .B =_bbdgg .B ;}else if _debb .B !=nil {_abf .B =_debb .B ;}else if _gcac .B !=nil {_abf .B =_gcac .B ;};};if _abf .BCs ==nil {if _bbdgg .BCs !=nil {_abf .BCs =_bbdgg .BCs ;}else if _debb .BCs !=nil {_abf .BCs =_debb .BCs ;}else if _gcac .BCs !=nil {_abf .BCs =_gcac .BCs ;};};if _abf .I ==nil {if _bbdgg .I !=nil {_abf .I =_bbdgg .I ;}else if _debb .I !=nil {_abf .I =_debb .I ;}else if _gcac .I !=nil {_abf .I =_gcac .I ;};};if _abf .ICs ==nil {if _bbdgg .ICs !=nil {_abf .ICs =_bbdgg .ICs ;}else if _debb .ICs !=nil {_abf .ICs =_debb .ICs ;}else if _gcac .ICs !=nil {_abf .ICs =_gcac .ICs ;};};if _abf .RFonts ==nil {if _bbdgg .RFonts !=nil {_abf .RFonts =_bbdgg .RFonts ;}else if _debb .RFonts !=nil {_abf .RFonts =_debb .RFonts ;}else if _gcac .RFonts !=nil {_abf .RFonts =_gcac .RFonts ;};};if _abf .VertAlign ==nil {if _bbdgg .VertAlign !=nil {_abf .VertAlign =_bbdgg .VertAlign ;}else if _debb .VertAlign !=nil {_abf .VertAlign =_debb .VertAlign ;}else if _gcac .VertAlign !=nil {_abf .VertAlign =_gcac .VertAlign ;};};return _abf ;};func (_gfeg *convertContext )addSeparator (){_gfeg .newParagraph ();_gfeg ._caa ._dde =true ;_gfeg ._caa ._de =_ef ;if _gfeg .currentParagraphOverflowsCurrentPage (){_gfeg .newPage ();_gfeg ._caa ._dc =_gfeg ._ebf ._acg ;};_gfeg .addCurrentParagraphToCurrentPage ();};func (_ffe *convertContext )determineParagraphBounds (){_ffe ._caa ._ed =_ffe ._ebf ._fff ._cc +_ffe ._caa ._ga ._cc ;_ffe ._caa ._aa =_ffe ._caa ._ed +_ffe ._caa ._bg ;_ffe ._caa ._aec =_ffe ._ebf ._fff ._ac -_ffe ._caa ._ga ._ac ;};func (_cga *convertContext )newLine (){_cbgd :=0.0;if _cga ._caa ==nil {_cga .newParagraph ();};_cbgd =_cga ._caa ._de +_cga ._caa ._ga ._ag ;_badd :=&line {};if len (_cga ._caa ._cdd )==0{_badd ._ec =_cga ._caa ._aa ;}else {_badd ._ec =_cga ._caa ._ed ;};_badd ._gg =_cga ._caa ._aec ;_badd ._edg =_badd ._ec ;_badd ._gfa =_cbgd ;_cga ._caa ._cdd =append (_cga ._caa ._cdd ,_badd );_cga ._bgfc =_badd ;_cga .newSpan ();};func _bdfe (_facd *_ae .CT_PPr ,_gcff *_gf .StyledParagraph )(float64 ,float64 ){if _facd .Jc !=nil {var _agd _gf .TextAlignment ;switch _facd .Jc .ValAttr {case _ae .ST_JcRight :_agd =_gf .TextAlignmentRight ;case _ae .ST_JcCenter :_agd =_gf .TextAlignmentCenter ;case _ae .ST_JcBoth :_agd =_gf .TextAlignmentJustify ;default:_agd =_gf .TextAlignmentLeft ;};_gcff .SetTextAlignment (_agd );};var _dfgf ,_bgea ,_cac ,_bdbf float64 ;_bada :=1.0;if _dggf :=_facd .Spacing ;_dggf !=nil {if _cdcc :=_dggf .BeforeAttr ;_cdcc !=nil {if _cdcc .ST_UnsignedDecimalNumber !=nil {_dfgf =_eaff (int64 (*_cdcc .ST_UnsignedDecimalNumber ));};};if _dfgd :=_dggf .AfterAttr ;_dfgd !=nil {if _dfgd .ST_UnsignedDecimalNumber !=nil {_bgea =_eaff (int64 (*_dfgd .ST_UnsignedDecimalNumber ));};};if _cgg :=_dggf .LineAttr ;_cgg !=nil {if _cgg .Int64 !=nil {_bada =float64 (*_cgg .Int64 /240);};};};if _dcdd :=_facd .Ind ;_dcdd !=nil {if _ddb :=_dcdd .LeftAttr ;_ddb !=nil {if _ddb .Int64 !=nil {_cac =_eaff (*_ddb .Int64 );};};if _afaf :=_dcdd .RightAttr ;_afaf !=nil {if _afaf .Int64 !=nil {_bdbf =_eaff (*_afaf .Int64 );};};};_gcff .SetMargins (_cac ,_bdbf ,_dfgf -_bada /2,_bgea +_bada /2);_gcff .SetLineHeight (_bada );return _dfgf ,_cac ;};func (_ffbe *convertContext )addCurrentWordToParagraph (){for {_eaec :=_ffbe ._bgfc ._edg ;_ggf :=_eaec +_ffbe ._eaf ._afc ;if _ggf > _ffbe ._bgfc ._gg {_ffbe .newLine ();};_fgac :=_ffbe ._caa ._dc +_ffbe ._bgfc ._gfa ;_add :=_fgac +_ffbe ._bgfc ._ge ;_abb :=false ;_fbb :=append (_ffbe ._ebf ._egd ,_ffbe ._caa ._bcd ...);for _ ,_bagf :=range _fbb {_fdfd :=_bagf ._ba ;if ((_fgac > _fdfd ._ag &&_fgac < _fdfd ._fg )||(_add > _fdfd ._ag &&_add < _fdfd ._fg ))&&((_eaec > _fdfd ._cc &&_eaec < _fdfd ._ac )||(_ggf > _fdfd ._cc &&_ggf < _fdfd ._ac )){_abb =true ;if _ffbe ._bgfc ._edg < _fdfd ._ac {_ffbe ._gcfa ._aed =_fdfd ._cc ;_ffbe ._bgfc ._edg =_fdfd ._ac ;_ffbe .newSpan ();};};};if !_abb {break ;};};if !_ffbe ._eaf ._cfg ||len (_ffbe ._gcfa ._adc )> 0{_ffbe ._eaf ._eda =_ffbe ._bgfc ._edg ;_ffbe ._gcfa ._adc =append (_ffbe ._gcfa ._adc ,_ffbe ._eaf );_ffbe ._bgfc ._edg +=_ffbe ._eaf ._afc ;for _ ,_egdf :=range _ffbe ._eaf ._fda {_ffbe .adjustHeights (_egdf ._bdc );};};};func _cec (_cdb ,_fcdc string ,_dbg ,_dca bool )[]*symbol {_defd :=[]*symbol {};for _ ,_eabc :=range _cdb {_fdf :=&symbol {_baf :string (_eabc ),_gea :_dbg ,_dec :_dca ,_ea :_fcdc };_defd =append (_defd ,_fdf );};return _defd ;};func _eaff (_dcdg int64 )float64 {return float64 (int64 (float64 (_dcdg )*_f .Twips /_f .Millimeter *100)/100);};type span struct{_agg float64 ;_aed float64 ;_adc []*word ;};type note struct{_dg string ;_ff []*_ae .EG_BlockLevelElts ;_agb *_gf .Block ;};func _gbbc (_afba *_ae .CT_TblWidth ,_caac float64 )float64 {if _cdeeg :=_afba .WAttr ;_cdeeg !=nil {if _egb :=_cdeeg .ST_DecimalNumberOrPercent ;_egb !=nil {if _accg :=_egb .ST_UnqualifiedPercentage ;_accg !=nil {switch _afba .TypeAttr {case _ae .ST_TblWidthDxa :return float64 (*_accg )/56.7;case _ae .ST_TblWidthPct :return _caac ;default:return _caac ;};};};};return _caac ;};func (_geba *convertContext )addAbsoluteRIC (_gbed *_ae .EG_RunInnerContent ,_fead *_ae .CT_RPr )bool {var _bbe bool ;_eaag :=[]*symbol {};if _gbed ==nil {if _geba ._gfde !=""{_eaag =_cec (_geba ._gfde ,"",true ,false );};}else {if _eec (_gbed ){return true ;}else if _gbed .T !=nil &&_gbed .T .Content !=""{_acd :=_gbed .T .Content ;if _ebb :=_geba ._egcg ;_ebb !=nil &&_ebb .IdAttr !=nil {_eaag =_cec (_acd ,_geba ._cea .GetTargetByRelId (*_ebb .IdAttr ),false ,false );}else {_eaag =_cec (_acd ,"",false ,false );};}else if _gcb :=_gbed .EndnoteReference ;_gcb !=nil {_gfdc :=_geba ._cea .BodySection ().X ();_bda :=_gcb .IdAttr ;_gbb :=_bda ;_bdba :=_ae .ST_NumberFormatLowerRoman ;if _gge :=_gfdc .EndnotePr ;_gge !=nil {if _cebc :=_gge .NumFmt ;_cebc !=nil {_bdba =_cebc .ValAttr ;};if _bdg :=_gge .NumStart ;_bdg !=nil {_gbb +=_bdg .ValAttr -1;};};_ecda :=_dfgb (_gbb ,_bdba );_dcb :=_geba ._cea .Endnote (_bda ).X ();if _dcb !=nil {_geba ._bbdeg =append (_geba ._bbdeg ,note {_dg :_ecda ,_ff :_dcb .EG_BlockLevelElts });_eaag =_cec (_ecda ,"",true ,false );};}else if _ddg :=_gbed .FootnoteReference ;_ddg !=nil {_dacd :=_geba ._cea .BodySection ().X ();_dbeb :=_ddg .IdAttr ;_feba :=_dbeb ;_gae :=_ae .ST_NumberFormatDecimal ;if _fgef :=_dacd .FootnotePr ;_fgef !=nil {if _afb :=_fgef .NumFmt ;_afb !=nil {_gae =_afb .ValAttr ;};if _fbac :=_fgef .NumStart ;_fbac !=nil {_feba +=_fbac .ValAttr -1;};};_ccb :=_dfgb (_feba ,_gae );_cgcb :=_geba ._cea .Footnote (_dbeb ).X ();if _cgcb !=nil {_efaf :=&note {_dg :_ccb ,_ff :_cgcb .EG_BlockLevelElts };_dgg :=[][]*_ae .EG_ContentBlockContent {};for _ ,_gccd :=range _cgcb .EG_BlockLevelElts {_dgg =append (_dgg ,_gccd .EG_ContentBlockContent );};_ecae ,_eccc :=_geba .makePdfBlockFromCBCs (_dgg ,_geba ._ebf ._fff ._ac -_geba ._ebf ._fff ._cc ,1000,nil ,true ,_ccb );if _eccc !=nil {_a .Println ("\u0043a\u006e\u006e\u006f\u0074\u0020\u0063\u006f\u006e\u0076\u0065\u0072t\u0020\u0066\u006f\u006f\u0074\u006e\u006f\u0074\u0065\u003a",_eccc );return false ;};_efaf ._agb =_ecae ;_geba ._caa ._fcb =append (_geba ._caa ._fcb ,_efaf );_geba ._caa ._deg +=_efaf ._agb .Height ();_eaag =_cec (_ccb ,"",true ,false );};}else if _ebe :=_gbed .Drawing ;_ebe !=nil {for _ ,_dae :=range _ebe .Inline {if _cgcg :=_dae .Graphic ;_cgcg !=nil {_efe ,_egff :=_geba .makePdfImageFromGraphics (_cgcg );if _egff !=nil {_a .Println ("\u0043a\u006en\u006f\u0074\u0020\u0072\u0065a\u0064\u0020i\u006d\u0061\u0067\u0065\u003a",_egff );};if _efe ==nil {return false ;};_fdage :=_dae .Extent ;if _fdage ==nil {return false ;};_cgcbf :=_f .FromEMU (_fdage .CxAttr )/_f .Millimeter ;_ded :=_f .FromEMU (_fdage .CyAttr )/_f .Millimeter ;_efe .Scale (_cgcbf /_efe .Width (),_ded /_efe .Height ());_eaag =[]*symbol {&symbol {_bdc :_ded ,_gac :_cgcbf ,_ffd :_efe }};_bbe =true ;};};};};var _acdd _gf .TextStyle ;var _cfeg ,_bafe bool ;if !_bbe {_acdd ,_cfeg ,_bafe =_geba .makeRunStyle (_fead ,false ,false ,false );};for _ ,_cee :=range _eaag {if _cee ._ffd !=nil {_geba .addInlineBlock (_cee );}else {_cee ._agbc =&_acdd ;_cee ._gea =_cfeg ;_cee ._dec =_bafe ;_geba .addTextSymbol (_cee );};};return false ;};func _ecgbe (_ceaf float64 )float64 {return 0.6+0.4*_ceaf };type paragraph struct{_bg float64 ;_ga *rectangle ;_aa float64 ;_ed float64 ;_aec float64 ;_dc float64 ;_de float64 ;_dcd _gf .TextAlignment ;_cb float64 ;_cdd []*line ;_ede *_gf .Table ;_bac []*_gf .Image ;_gc []*_gf .Image ;_gb []*textbox ;_bad []*textbox ;_fcb []*note ;_deg float64 ;_bcd []*zoneToSkip ;_aga float64 ;_dde bool ;};type word struct{_fda []*symbol ;_eda float64 ;_afc float64 ;_cfg bool ;};func (_ceg *convertContext )addParagraphs (_gfg []*_ae .CT_P ){for _ ,_bb :=range _gfg {_ccgf :=_bbeb (_ceg ._cea ,_bb .PPr );if _ceg .addAbsoluteEGPC (_bb .EG_PContent ,_ccgf ){_ceg .newPage ();continue ;};if _ceg .currentParagraphOverflowsCurrentPage (){_ceg .newPage ();_ceg .addAbsoluteEGPC (_bb .EG_PContent ,_ccgf );};_ceg .addCurrentParagraphToCurrentPage ();};};func (_fdfa *convertContext )addCurrentParagraphToCurrentPage (){_fdfa ._ebf ._acg =_fdfa ._caa ._dc +_fdfa ._caa ._ga ._ag +_fdfa ._caa ._de +_fdfa ._caa ._ga ._fg ;_fdfa ._ebf ._fc =append (_fdfa ._ebf ._fc ,_fdfa ._caa ._bac ...);_fdfa ._ebf ._db =append (_fdfa ._ebf ._db ,_fdfa ._caa ._gc ...);_fdfa ._ebf ._fd =append (_fdfa ._ebf ._fd ,_fdfa ._caa ._gb ...);_fdfa ._ebf ._cf =append (_fdfa ._ebf ._cf ,_fdfa ._caa ._bad ...);_fdfa ._ebf ._egd =append (_fdfa ._ebf ._egd ,_fdfa ._caa ._bcd ...);_fdfa ._ebf ._cd =append (_fdfa ._ebf ._cd ,_fdfa ._caa );_fdfa .adjustRightBoundOfLastSpan ();_fdfa .alignParagraph ();if len (_fdfa ._ebf ._fe )==0&&len (_fdfa ._caa ._fcb )> 0{_fdfa ._ebf ._fff ._fg -=_ef ;};_fdfa ._ebf ._fe =append (_fdfa ._ebf ._fe ,_fdfa ._caa ._fcb ...);_fdfa ._ebf ._fff ._fg -=_fdfa ._caa ._deg ;};

// ConvertToPdf converts document to PDF file. This package is beta, breaking changes can take place.
func ConvertToPdf (d *_c .Document )*_gf .Creator {_dgf :=d .BodySection ().X ();var _ebfa ,_daee ,_egacc ,_bcfge ,_bbed ,_ceac float64 ;_fca :=_dgf .PgMar ;if _fca .LeftAttr .ST_UnsignedDecimalNumber !=nil {_ebfa =_eaff (int64 (*_fca .LeftAttr .ST_UnsignedDecimalNumber ));};if _fca .LeftAttr .ST_UnsignedDecimalNumber !=nil {_daee =_eaff (int64 (*_fca .RightAttr .ST_UnsignedDecimalNumber ));};if _fca .TopAttr .Int64 !=nil {_egacc =_eaff (*_fca .TopAttr .Int64 );};if _fca .BottomAttr .Int64 !=nil {_bcfge =_eaff (*_fca .BottomAttr .Int64 );};_gca :=_dgf .PgSz ;_fcca ,_afgf :=210.0,297.0;if _gca .WAttr !=nil {_fcca =_eaff (int64 (*_gca .WAttr .ST_UnsignedDecimalNumber ));};if _gca .HAttr !=nil {_afgf =_eaff (int64 (*_gca .HAttr .ST_UnsignedDecimalNumber ));};if _fca .HeaderAttr .ST_UnsignedDecimalNumber !=nil {_bbed =_eaff (int64 (*_fca .HeaderAttr .ST_UnsignedDecimalNumber ));};if _fca .FooterAttr .ST_UnsignedDecimalNumber !=nil {_ceac =_bcfge -_eaff (int64 (*_fca .FooterAttr .ST_UnsignedDecimalNumber ));};_ecbaa :=_gf .New ();_ecbaa .SetPageSize (_gf .PageSize {_fcca ,_afgf });_ecbaa .SetPageMargins (_ebfa ,_daee ,_egacc ,_bcfge );for _ ,_cbgg :=range d .Headers (){_adcae :=&convertContext {_fag :_ecbaa ,_cea :d ,_cdg :true ,_ggdb :_ebfa ,_bfa :_bbed };_adcae .addRelativeCBCs (_cbgg .X ().EG_ContentBlockContent );};for _ ,_aebe :=range d .Footers (){_dggc :=&convertContext {_fag :_ecbaa ,_cea :d ,_fagb :true ,_ggdb :_ebfa ,_bfe :_ceac };_dggc .addRelativeCBCs (_aebe .X ().EG_ContentBlockContent );};_egfbg :=&convertContext {_fag :_ecbaa ,_cea :d ,_bcbb :&rectangle {_ag :_egacc ,_fg :_afgf -_bcfge ,_cc :_ebfa ,_ac :_fcca -_daee },_bbdeg :[]note {}};for _ ,_aaddg :=range d .X ().Body .EG_BlockLevelElts {_egfbg .addAbsoluteCBCs (_aaddg .EG_ContentBlockContent );};_egfbg .addEndnotes ();_egfbg .alignSymbolsVertically ();_egfbg .drawPages ();return _ecbaa ;};func _eec (_abcgf *_ae .EG_RunInnerContent )bool {if _bffb :=_abcgf .Br ;_bffb !=nil {return _bffb .TypeAttr ==_ae .ST_BrTypePage ;};return false ;};func (_cbf *convertContext )addAbsoluteCBCs (_gfb []*_ae .EG_ContentBlockContent ){for _ ,_ccg :=range _gfb {_cbf .addParagraphs (_ccg .P );_cbf .addTables (_ccg .Tbl );};};func (_bba *span )moveRight (_fga float64 ){for _ ,_eegf :=range _bba ._adc {_eegf ._eda +=_fga ;};};type line struct{_gfa float64 ;_ec float64 ;_gg float64 ;_edg float64 ;_ge float64 ;_agac []*span ;};func (_fb *convertContext )alignParagraph (){_edee :=_fb ._caa ;if _edee ._dcd ==_gf .TextAlignmentLeft {return ;};_ecg :=len (_edee ._cdd )-1;for _fcbf ,_adbd :=range _edee ._cdd {_ecb :=len (_adbd ._agac )-1;for _ggd ,_dcf :=range _adbd ._agac {_cge :=true ;_aaa :=len (_dcf ._adc );_ecce :=0.0;for _gd :=len (_dcf ._adc )-1;_gd >=0;_gd --{_acfe :=_dcf ._adc [_gd ];if _cge &&_acfe ._cfg {_aaa =_gd ;}else {_cge =false ;for _ ,_geg :=range _acfe ._fda {_ecce +=_geg ._gac ;};};};_dcf ._adc =_dcf ._adc [:_aaa ];_ddc :=_dcf ._aed -_dcf ._agg -_ecce ;switch _edee ._dcd {case _gf .TextAlignmentRight :_dcf .moveRight (_ddc );case _gf .TextAlignmentCenter :_dcf .moveRight (_ddc /2);case _gf .TextAlignmentJustify :if _fcbf !=_ecg ||_ggd !=_ecb {_dfad :=[]*word {};for _ ,_bace :=range _dcf ._adc {if _bace ._cfg {_dfad =append (_dfad ,_bace );};};_cfe :=_ddc /float64 (len (_dfad ));for _ ,_dadc :=range _dfad {_dadc ._afc +=_cfe ;};var _bbd *word ;for _ ,_bca :=range _dcf ._adc {if _bbd !=nil {_bca ._eda =_bbd ._eda +_bbd ._afc ;};_bbd =_bca ;};};};};};};func _aefad (_cbaf ,_eadf float64 )*_gf .Creator {_cfdf :=_gf .New ();_cfdf .SetPageSize (_gf .PageSize {_cbaf ,_eadf });_cfdf .SetPageMargins (0,0,0,0);return _cfdf ;};func (_gbbd *convertContext )makePdfBlockFromCBCs (_dfda [][]*_ae .EG_ContentBlockContent ,_fab ,_bdgb float64 ,_ebfe *rectangle ,_adcg bool ,_caad string )(*_gf .Block ,error ){if _ebfe ==nil {_ebfe =&rectangle {};};_gbec :=&rectangle {_ag :_ebfe ._ag ,_fg :_bdgb -_ebfe ._fg ,_cc :_ebfe ._cc ,_ac :_fab -_ebfe ._ac };_fdfe :=_aefad (_fab ,_bdgb );_cecf :=&convertContext {_fag :_fdfe ,_cea :_gbbd ._cea ,_bcbb :_gbec ,_gfde :_caad };for _ ,_bgd :=range _dfda {_cecf .addAbsoluteCBCs (_bgd );};if _adcg {_ffdg :=0.0;for _ ,_eccg :=range _cecf ._agbb {for _ ,_afcb :=range _eccg ._cd {_ffdg +=(_afcb ._de +_afcb ._ga ._ag +_afcb ._ga ._fg );};};_gbec ._fg =_ffdg -_ebfe ._fg ;_fdfe =_aefad (_fab ,_ffdg );_cecf =&convertContext {_fag :_fdfe ,_cea :_gbbd ._cea ,_bcbb :_gbec ,_gfde :_caad };for _ ,_bacb :=range _dfda {_cecf .addAbsoluteCBCs (_bacb );};};_cecf .alignSymbolsVertically ();_cecf .drawPage (_cecf ._agbb [0]);_dabaa :=_g .NewBuffer ([]byte {});_bef :=_fdfe .Write (_dabaa );if _bef !=nil {return nil ,_bef ;};_eeff :=_g .NewReader (_dabaa .Bytes ());_bfae ,_bef :=_eg .NewPdfReader (_eeff );if _bef !=nil {return nil ,_bef ;};_cebb ,_bef :=_bfae .GetPage (1);if _bef !=nil {return nil ,_bef ;};_deedb ,_bef :=_gf .NewBlockFromPage (_cebb );if _bef !=nil {return nil ,_bef ;};return _deedb ,nil ;};type rectangle struct{_ag float64 ;_fg float64 ;_cc float64 ;_ac float64 ;};func (_fbbd *convertContext )addHdrFtr (_agdg []*_ae .CT_P ){for _ ,_bbdf :=range _agdg {_gee :=_fbbd ._fag .NewStyledParagraph ();_fbbd ._ecdg =_gee ;_aabb :=_bbeb (_fbbd ._cea ,_bbdf .PPr );_ecdgd ,_cccg :=_bdfe (_aabb ,_gee );_fbbd .addRelativeEGPC (_bbdf .EG_PContent ,_aabb .RPr );if _fbbd ._cdg {_fbbd ._fag .DrawHeader (func (_gbg *_gf .Block ,_facf _gf .HeaderFunctionArgs ){_gee .SetPos (_fbbd ._ggdb +_cccg ,_ecdgd +_fbbd ._bfa );_gbg .Draw (_gee );});}else if _fbbd ._fagb {_fbbd ._fag .DrawFooter (func (_gbgg *_gf .Block ,_cag _gf .FooterFunctionArgs ){_gee .SetPos (_fbbd ._ggdb +_cccg ,_ecdgd +_fbbd ._bfe -_fbbd ._bceb );_gbgg .Draw (_gee );});};};};type zoneToSkip struct{_ba *rectangle ;_cg *_ae .WdEG_WrapTypeChoice ;};func (_cbcd *convertContext )addRelativeCBCs (_fagbe []*_ae .EG_ContentBlockContent ){for _ ,_dbcf :=range _fagbe {_cbcd .addHdrFtr (_dbcf .P );};};func (_ecfe *convertContext )currentParagraphOverflowsCurrentPage ()bool {_cab :=_ecfe ._caa ._dc +_ecfe ._caa ._ga ._ag +_ecfe ._caa ._ga ._fg ;_cgd :=_ecfe ._ebf ._fff ._fg -_ecfe ._caa ._deg ;if len (_ecfe ._ebf ._fe )==0&&len (_ecfe ._caa ._fcb )> 0{_cgd -=_ef ;};return _cab +_ecfe ._caa ._de > _cgd ||_cab +_ecfe ._caa ._aga > _cgd ;};func (_bged *convertContext )newPage (){_fae :=&page {};_fae ._fff =_bged ._bcbb ;_fae ._acg =_fae ._fff ._ag ;if _bged ._bbb {_fae ._agf =true ;_fae ._acg +=_ef ;};_bged ._agbb =append (_bged ._agbb ,_fae );_bged ._ebf =_fae ;};func (_gcfc *convertContext )makePdfImageFromGraphics (_bdbg *_bd .Graphic )(*_gf .Image ,error ){if _beega :=_bdbg .GraphicData ;_beega !=nil {for _ ,_cggb :=range _beega .Any {if _agcgg ,_aag :=_cggb .(*_dd .Pic );_aag {if _becd :=_agcgg .BlipFill ;_becd !=nil {if _geaa :=_becd .Blip ;_geaa !=nil {if _eada :=_geaa .EmbedAttr ;_eada !=nil {_geab ,_geee :=_gcfc ._cea .GetImageObjByRelId (*_eada );if _geee !=nil {return nil ,_geee ;};_cfad ,_geee :=_d .Open (_geab .Path );if _geee !=nil {return nil ,_geee ;};_agag ,_geee :=_ad .ReadAll (_cfad );if _geee !=nil {return nil ,_geee ;};_gfgbe ,_geee :=_gcfc ._fag .NewImageFromData (_agag );if _geee !=nil {return nil ,_geee ;};return _gfgbe ,nil ;};};};};};};return nil ,nil ;};func _afg (_dfb *_gf .Creator ,_eab ,_gbf ,_da ,_ab ,_ca float64 ,_bcb _gf .Color ){_ee :=_dfb .NewLine (_eab ,_gbf ,_da ,_ab );_ee .SetLineWidth (_ca );_ee .SetColor (_bcb );_dfb .Draw (_ee );};func (_bbde *convertContext )addAbsoluteTable (_edaa *_ae .CT_Tbl )*_gf .Table {_gfad :=_edaa .TblGrid ;if _gfad ==nil {return nil ;};_adca :=len (_gfad .GridCol );if _adca ==0{return nil ;};_agad :=[]float64 {};_bcdd :=[]float64 {};_gdb :=0.0;for _ ,_fdc :=range _gfad .GridCol {_dgc :=0.0;if _fdc .WAttr .ST_UnsignedDecimalNumber !=nil {_dgc =_eaff (int64 (*_fdc .WAttr .ST_UnsignedDecimalNumber ));};_agad =append (_agad ,_dgc );_gdb +=_dgc ;};for _ebgg :=0;_ebgg < _adca ;_ebgg ++{_bcdd =append (_bcdd ,_agad [_ebgg ]/_gdb );};_gacb :=_bbde ._fag .NewTable (_adca );_gacb .SetColumnWidths (_bcdd ...);_gcf :=_agcb (_bbde ._cea ,_edaa .TblPr );_ffg :=len (_edaa .EG_ContentRowContent );for _adad ,_fdga :=range _edaa .EG_ContentRowContent {if _fdga ==nil {continue ;};if _gdgcc :=_fdga .Tr ;len (_gdgcc )> 0{_dbf :=_gdgcc [0];for _gbag ,_fdgc :=range _dbf .EG_ContentCellContent {if _egc :=_fdgc .Tc ;len (_egc )> 0{_dada :=_egc [0];if _dada !=nil {_gafgc :=_gacb .NewCell ();_edc :=_fcbe (_gcf ,_dada .TcPr ,_adad ,_gbag ,_ffg ,_adca );_bdga :=1.9;_bcfg :=_gf .CellVerticalAlignmentTop ;if _edc !=nil {if _cbfe :=_edc .TcBorders ;_cbfe !=nil {if _fde :=_cbfe .Left ;_fde !=nil {_cgf ,_ace ,_cde :=_ggce (_fde );_gafgc .SetBorder (_gf .CellBorderSideLeft ,_cgf ,_cde );if _ace !=nil &&*_ace !=nil {_gafgc .SetSideBorderColor (_gf .CellBorderSideLeft ,*_ace );};};if _febb :=_cbfe .Top ;_febb !=nil {_ebbb ,_acgg ,_edaaa :=_ggce (_febb );_gafgc .SetBorder (_gf .CellBorderSideTop ,_ebbb ,_edaaa );if _acgg !=nil &&*_acgg !=nil {_gafgc .SetSideBorderColor (_gf .CellBorderSideTop ,*_acgg );};};if _aca :=_cbfe .Right ;_aca !=nil {_decd ,_gdgca ,_bbea :=_ggce (_aca );_gafgc .SetBorder (_gf .CellBorderSideRight ,_decd ,_bbea );if _gdgca !=nil &&*_gdgca !=nil {_gafgc .SetSideBorderColor (_gf .CellBorderSideRight ,*_gdgca );};};if _gdc :=_cbfe .Bottom ;_gdc !=nil {_bcef ,_gegf ,_abcg :=_ggce (_gdc );_gafgc .SetBorder (_gf .CellBorderSideBottom ,_bcef ,_abcg );if _gegf !=nil &&*_gegf !=nil {_gafgc .SetSideBorderColor (_gf .CellBorderSideBottom ,*_gegf );};};}else {_gafgc .SetBorder (_gf .CellBorderSideAll ,_gf .CellBorderStyleSingle ,0.125);_gafgc .SetBorderColor (_gf .ColorBlack );};if _fgca :=_edc .Shd ;_fgca !=nil {if _gafc :=_fgca .FillAttr ;_gafc !=nil {if _adf :=_gafc .ST_HexColorRGB ;_adf !=nil {_ffbc :=_gf .ColorRGBFromHex ("\u0023"+*_adf );_gafgc .SetBackgroundColor (_ffbc );};};};if _ffa :=_edc .TcMar ;_ffa !=nil {if _fad :=_ffa .Left ;_fad !=nil {_bdga =_gbbc (_fad ,1.9);};};if _efbe :=_edc .VAlign ;_efbe !=nil {switch _efbe .ValAttr {case _ae .ST_VerticalJcCenter :_bcfg =_gf .CellVerticalAlignmentMiddle ;case _ae .ST_VerticalJcBottom :_bcfg =_gf .CellVerticalAlignmentBottom ;};};};_gafgc .SetVerticalAlignment (_bcfg );_gafgc .SetIndent (_bdga );_cba :=_dada .EG_BlockLevelElts ;_egfb :=_bbde ._fag .NewStyledParagraph ();_cdfc :=false ;for _ ,_dbc :=range _cba {for _ ,_acdg :=range _dbc .EG_ContentBlockContent {_fef :=true ;for _ ,_dfeg :=range _acdg .P {_dcfg :=_bbeb (_bbde ._cea ,_dfeg .PPr );for _ ,_gdd :=range _dfeg .EG_PContent {for _ ,_bee :=range _gdd .EG_ContentRunContent {if _deda :=_bee .R ;_deda !=nil {_dfg :=_eeaa (_bbde ._cea ,_deda .RPr ,_dcfg .RPr );for _ ,_aeag :=range _deda .EG_RunInnerContent {var _cdec *_gf .TextChunk ;if _aeag .T !=nil &&_aeag .T .Content !=""{if _cdfc {if _fef {_egac :=_egfb .Append ("\u000a");_ddfd :=_bbde ._fag .NewTextStyle ();_ddfd .FontSize =0;_egac .Style =_ddfd ;_fef =false ;};}else {_cdfc =true ;};_cdec =_egfb .Append (_aeag .T .Content );_cdec .Style ,_ ,_ =_bbde .makeRunStyle (_dfg ,false ,false ,false );};};};};};if _egfb !=nil {_bdfe (_dcfg ,_egfb );};};};};_gafgc .SetContent (_egfb );};};};_eccec :=1.0;if _ecdaa :=_dbf .TrPr ;_ecdaa !=nil {if len (_ecdaa .TrHeight )!=0{_adab :=_ecdaa .TrHeight [0];if _acda :=_adab .ValAttr ;_acda !=nil {if _acda .ST_UnsignedDecimalNumber !=nil {_eccec =_eaff (int64 (*_acda .ST_UnsignedDecimalNumber ));};};};};_gacb .SetRowHeight (_gacb .CurRow (),_eccec );};};_eef :=0.0;_cce :=true ;if _acga :=_gcf .Jc ;_acga !=nil {_cce =_acga .ValAttr ==_ae .ST_JcTableLeft ;};if _cce {if _cfgbb :=_gcf .TblInd ;_cfgbb !=nil {_eef =_gbbc (_cfgbb ,50);};};_dfec :=1.0;_gacb .SetMargins (_eef -1,0,_dfec ,_dfec );return _gacb ;};func (_abaf *convertContext )addTables (_gbaa []*_ae .CT_Tbl ){for _ ,_eed :=range _gbaa {_aabe :=_abaf .addAbsoluteTable (_eed );if _aabe ==nil {continue ;};_cgdb :=_aefad (1000,1000);_cgdb .Draw (_aabe );_abaf .newParagraph ();_abaf ._caa ._ga =&rectangle {1,1,1,1};_abaf ._caa ._ede =_aabe ;_abaf ._caa ._de =_aabe .Height ();_abaf .determineParagraphBounds ();if _abaf .currentParagraphOverflowsCurrentPage (){_abaf .newPage ();_abaf .determineParagraphBounds ();};_abaf .addCurrentParagraphToCurrentPage ();};};func _agcb (_beg *_c .Document ,_bgaca *_ae .CT_TblPr )*_ae .CT_TblPr {if _bgaca ==nil {_bgaca =_ae .NewCT_TblPr ();};if _bgaca .TblStyle !=nil {_dfbgd :=_beg .GetStyleByID (_bgaca .TblStyle .ValAttr );if _bbc :=_dfbgd .X ();_bbc !=nil {if _cege :=_bbc .TblPr ;_cege !=nil {_aadbb :=_bgaca .TblBorders ;_gfafc :=_cege .TblBorders ;if _aadbb ==nil {_aadbb =_gfafc ;}else {if _aadbb .Top ==nil {_aadbb .Top =_gfafc .Top ;};if _aadbb .Bottom ==nil {_aadbb .Bottom =_gfafc .Bottom ;};if _aadbb .Left ==nil {_aadbb .Left =_gfafc .Left ;};if _aadbb .Right ==nil {_aadbb .Right =_gfafc .Right ;};if _aadbb .InsideH ==nil {_aadbb .InsideH =_gfafc .InsideH ;};if _aadbb .InsideV ==nil {_aadbb .InsideV =_gfafc .InsideV ;};};_dbb :=_bgaca .Shd ;_agbg :=_cege .Shd ;if _dbb ==nil {_dbb =_agbg ;}else {if _agbg !=nil &&_dbb .FillAttr ==nil {_dbb .FillAttr =_agbg .FillAttr ;};};_dbgc :=_bgaca .TblCellMar ;_ccba :=_cege .TblCellMar ;if _dbgc ==nil {_dbgc =_ccba ;}else {if _ccba !=nil &&_dbgc .Left ==nil {_dbgc .Left =_ccba .Left ;};};if _bgaca .TblInd ==nil {_bgaca .TblInd =_cege .TblInd ;};if _bgaca .Jc ==nil {_bgaca .Jc =_cege .Jc ;};};};};return _bgaca ;};func (_bcbc *convertContext )addParagraphTextboxes (_afab []*_ae .EG_PContent ){for _ ,_baecc :=range _afab {for _ ,_ffbf :=range _baecc .EG_ContentRunContent {if _gdgc :=_ffbf .R ;_gdgc !=nil {for _ ,_bfb :=range _gdgc .Extra {if _efb ,_bafb :=_bfb .(*_ae .AlternateContentRun );_bafb {if _ged :=_efb .Choice ;_ged !=nil {if _ecd :=_ged .Drawing ;_ecd !=nil {for _ ,_bab :=range _ecd .Anchor {var _ecgd ,_bdcf ,_egg ,_fgc float64 ;_eeb ,_fee :=_bab .PositionH ,_bab .PositionV ;if _accd :=_eeb .Choice ;_accd !=nil {if _accd .PosOffset !=nil {_ecgd =_f .FromEMU (int64 (*_accd .PosOffset ))/_f .Millimeter ;};};if _eaa :=_fee .Choice ;_eaa !=nil {if _eaa .PosOffset !=nil {_bdcf =_f .FromEMU (int64 (*_eaa .PosOffset ))/_f .Millimeter ;};};if _bcc :=_bab .Extent ;_bcc !=nil {_fgc =_f .FromEMU (_bcc .CxAttr )/_f .Millimeter ;_egg =_f .FromEMU (_bcc .CyAttr )/_f .Millimeter ;};_aef :=_bcbc ._caa ._dc +_bdcf ;_bdd :=_aef +_egg ;_aeba :=_bcbc ._caa ._ed +_ecgd ;_bec :=_aeba +_fgc ;_fa :=_bdcf +_egg ;if _fa > _bcbc ._caa ._aga {_bcbc ._caa ._aga =_fa ;};if _bab .Choice !=nil &&_bab .Choice .WrapNone ==nil {_bcbc ._caa ._bcd =append (_bcbc ._caa ._bcd ,&zoneToSkip {_ba :&rectangle {_ag :_aef ,_fg :_bdd ,_cc :_aeba ,_ac :_bec },_cg :_bab .Choice });};if _geac :=_bab .Graphic ;_geac !=nil {_bde ,_bge :=_bcbc .makePdfBlockFromGraphics (_geac );if _bge !=nil {_a .Println ("C\u0061n\u006e\u006f\u0074\u0020\u0072\u0065\u0061\u0064 \u0074\u0065\u0078\u0074bo\u0078\u003a",_bge );};if _bde !=nil {_bde ._gab .Scale (_fgc /_bde ._gab .Width (),_egg /_bde ._gab .Height ());_bde ._adcd =_aeba ;_bde ._gfaa =_aef ;if _bab .BehindDocAttr {_bcbc ._caa ._bad =append (_bcbc ._caa ._bad ,_bde );}else {_bcbc ._caa ._gb =append (_bcbc ._caa ._gb ,_bde );};};};};};};};};};};};};func (_ddf *convertContext )drawPage (_feg *page ){if _feg ._agf {_gef :=_feg ._fff ._ag +_ef *_af ;_fec :=_feg ._fff ._cc ;_dab :=_feg ._fff ._ac ;_afg (_ddf ._fag ,_fec ,_gef ,_dab ,_gef ,0.25,_gf .ColorBlack );};for _ ,_aac :=range _feg ._db {_ddf ._fag .Draw (_aac );};for _ ,_baa :=range _feg ._cf {_cbg (_ddf ._fag ,_baa );};for _ ,_aee :=range _feg ._cd {if _aee ._dde {_geff :=_aee ._dc +_ef *_af ;_fcc :=_feg ._fff ._cc ;_aad :=_fcc +50;_afg (_ddf ._fag ,_fcc ,_geff ,_aad ,_geff ,0.25,_gf .ColorBlack );}else {for _ ,_eeg :=range _aee ._cdd {for _ ,_dce :=range _eeg ._agac {for _ ,_aff :=range _dce ._adc {for _ ,_dbd :=range _aff ._fda {if _dbd ._ffd !=nil {_dbd ._ffd .SetPos (_aff ._eda +_dbd ._acf ,_aee ._dc +_eeg ._gfa +_dbd ._df );_ddf ._fag .Draw (_dbd ._ffd );}else if _dbd ._eb !=nil {_dbd ._eb ._adcd =_aff ._eda +_dbd ._acf ;_dbd ._eb ._gfaa =_aee ._dc +_eeg ._gfa +_dbd ._df ;_cbg (_ddf ._fag ,_dbd ._eb );}else {_aaf :=_ddf ._fag .NewStyledParagraph ();if _dbd ._gea {_dbd ._df =0;}else if _dbd ._dec {_dbd ._df =1.2*_eeg ._ge -_dbd ._bdc ;};_afgd :=_aff ._eda +_dbd ._acf ;_bdca :=_aee ._dc +_eeg ._gfa +_dbd ._df ;_aaf .SetPos (_afgd ,_bdca );var _cfc *_gf .TextChunk ;if _dbd ._ea !=""{_cfc =_aaf .AddExternalLink (_dbd ._baf ,_dbd ._ea );}else {_cfc =_aaf .Append (_dbd ._baf );};if _dbd ._agbc !=nil {_cfc .Style =*_dbd ._agbc ;};_ddf ._fag .Draw (_aaf );};};};};};if _aee ._ede !=nil {_bag :=_gf .NewBlock (_aee ._aec -_aee ._ed ,_aee ._ga ._ag +_aee ._de +_aee ._ga ._fg );_bag .SetPos (_aee ._aa ,_aee ._dc +_aee ._ga ._ag );_bag .Draw (_aee ._ede );_ddf ._fag .Draw (_bag );};};};for _ ,_afa :=range _feg ._fc {_ddf ._fag .Draw (_afa );};for _ ,_eae :=range _feg ._fd {_cbg (_ddf ._fag ,_eae );};if len (_feg ._fe )> 0{_fcbd :=_feg ._fff ._fg +_ef *_af ;_edag :=_feg ._fff ._cc ;_afff :=_edag +50;_afg (_ddf ._fag ,_edag ,_fcbd ,_afff ,_fcbd ,0.25,_gf .ColorBlack );_eee :=_feg ._fff ._fg +_ef ;for _ ,_dad :=range _feg ._fe {_dad ._agb .SetPos (_feg ._fff ._cc ,_eee );_ddf ._fag .Draw (_dad ._agb );_eee +=_dad ._agb .Height ();};};};func _bbeb (_eagb *_c .Document ,_bgga *_ae .CT_PPr )*_ae .CT_PPr {if _bgga !=nil &&_bgga .PStyle !=nil {_bggd :=_eagb .GetStyleByID (_bgga .PStyle .ValAttr );if _fgdb :=_bggd .X ();_fgdb !=nil {if _bfg :=_fgdb .PPr ;_bfg !=nil {if _bgga .Jc ==nil &&_bfg .Jc !=nil {_bgga .Jc =_bfg .Jc ;};if _bgga .Spacing ==nil &&_bfg .Spacing !=nil {_bgga .Spacing =_bfg .Spacing ;};if _bgga .Ind ==nil &&_bfg .Ind !=nil {_bgga .Ind =_bfg .Ind ;};};if _aeeb :=_fgdb .RPr ;_aeeb !=nil {_cfegg :=*_bgga .RPr ;if _aeeb .Color !=nil {_cfegg .Color =_aeeb .Color ;};if _aeeb .Spacing !=nil {_cfegg .Spacing =_aeeb .Spacing ;};if _aeeb .Sz !=nil {_cfegg .Sz =_aeeb .Sz ;};if _aeeb .SzCs !=nil {_cfegg .SzCs =_aeeb .SzCs ;};if _aeeb .B !=nil {_cfegg .B =_aeeb .B ;};if _aeeb .BCs !=nil {_cfegg .BCs =_aeeb .BCs ;};if _aeeb .I !=nil {_cfegg .I =_aeeb .I ;};if _aeeb .ICs !=nil {_cfegg .ICs =_aeeb .ICs ;};if _aeeb .RFonts !=nil {_cfegg .RFonts =_aeeb .RFonts ;};if _aeeb .VertAlign !=nil {_cfegg .VertAlign =_aeeb .VertAlign ;};_bgga .RPr =&_cfegg ;};};};return _bgga ;};func (_agbd *convertContext )adjustHeights (_eaeg float64 ){if _agbd ._bgfc ._ge < _eaeg {_agbd ._caa ._de +=(_eaeg -_agbd ._bgfc ._ge );_agbd ._bgfc ._ge =_eaeg ;};};func _fac (_acca *_ae .CT_PPr ,_adda *paragraph )(float64 ,float64 ){if _acca ==nil {return 0,0;};if _acca .Jc !=nil {switch _acca .Jc .ValAttr {case _ae .ST_JcRight :_adda ._dcd =_gf .TextAlignmentRight ;case _ae .ST_JcCenter :_adda ._dcd =_gf .TextAlignmentCenter ;case _ae .ST_JcBoth :_adda ._dcd =_gf .TextAlignmentJustify ;default:_adda ._dcd =_gf .TextAlignmentLeft ;};};var _ecba ,_agab ,_ece ,_affg ,_cfbg float64 ;_ggde :=1.0;if _dade :=_acca .Spacing ;_dade !=nil {if _bfba :=_dade .BeforeAttr ;_bfba !=nil {if _bfba .ST_UnsignedDecimalNumber !=nil {_ecba =_eaff (int64 (*_bfba .ST_UnsignedDecimalNumber ));};};if _dff :=_dade .AfterAttr ;_dff !=nil {if _dff .ST_UnsignedDecimalNumber !=nil {_agab =_eaff (int64 (*_dff .ST_UnsignedDecimalNumber ));};};if _acag :=_dade .LineAttr ;_acag !=nil {if _acag .Int64 !=nil &&*_acag .Int64 !=0{_ggde =float64 (*_acag .Int64 /240);};};};if _ecgb :=_acca .Ind ;_ecgb !=nil {if _bcac :=_ecgb .FirstLineAttr ;_bcac !=nil {if _bcac .ST_UnsignedDecimalNumber !=nil {_cfbg =_eaff (int64 (*_bcac .ST_UnsignedDecimalNumber ));};};if _gfe :=_ecgb .LeftAttr ;_gfe !=nil {if _gfe .Int64 !=nil {_ece =_eaff (*_gfe .Int64 );};};if _egfe :=_ecgb .RightAttr ;_egfe !=nil {if _egfe .Int64 !=nil {_affg =_eaff (*_egfe .Int64 );};};};_adda ._ga =&rectangle {_ag :_ecba ,_fg :_agab ,_cc :_ece ,_ac :_affg };_adda ._bg =_cfbg ;_adda ._cb =_ggde ;return _ecba ,_ece ;};func (_cbc *convertContext )drawPages (){for _ ,_eea :=range _cbc ._agbb {_cbc ._fag .NewPage ();_cbc .drawPage (_eea );};};func (_faf *convertContext )newParagraph (){if _faf ._ebf ==nil {_faf .newPage ();};_bgacd :=&paragraph {};_bgacd ._ga =&rectangle {};_bgacd ._dc =_faf ._ebf ._acg ;_faf ._caa =_bgacd ;};func (_cdf *convertContext )addAbsoluteEGPC (_edgd []*_ae .EG_PContent ,_aab *_ae .CT_PPr )bool {_cdf .newParagraph ();_fac (_aab ,_cdf ._caa );_cdf .determineParagraphBounds ();_cdf .addParagraphImages (_edgd );_cdf .addParagraphTextboxes (_edgd );_cdf .newLine ();_cdf .newWord ();if len (_edgd )==0{_cdf .addEmptyLine ();return false ;};for _ ,_fgd :=range _edgd {for _ ,_cbcb :=range _fgd .FldSimple {if _cbcb !=nil {_cdf .addAbsoluteEGPC (_cbcb .EG_PContent ,_aab );};};if _fed :=_fgd .Hyperlink ;_fed !=nil {_cdf ._egcg =_fed ;_cdf .addAbsoluteCRC (_fed .EG_ContentRunContent ,_aab .RPr );};_cdf ._egcg =nil ;if _cdf .addAbsoluteCRC (_fgd .EG_ContentRunContent ,_aab .RPr ){return true ;};};_cdf .addCurrentWordToParagraph ();return false ;};func (_gedc *convertContext )addRelativeCRC (_ead []*_ae .EG_ContentRunContent ,_cdbe *_ae .CT_ParaRPr ){for _ ,_ddcf :=range _ead {if _gbgb :=_ddcf .R ;_gbgb !=nil {_dfegd :=_eeaa (_gedc ._cea ,_gbgb .RPr ,_cdbe );if _gedc ._gfde !=""{_gedc .addRelativeRIC (nil ,_dfegd );_gedc ._gfde ="";};for _ ,_bbgd :=range _gbgb .EG_RunInnerContent {_gedc .addRelativeRIC (_bbgd ,_dfegd );};};};};func _ggce (_bdgc *_ae .CT_Border )(_gf .CellBorderStyle ,*_gf .Color ,float64 ){if _bdgc ==nil {return _gf .CellBorderStyleNone ,nil ,0;};var _gaa _gf .CellBorderStyle ;switch _bdgc .ValAttr {case _ae .ST_BorderSingle :_gaa =_gf .CellBorderStyleSingle ;case _ae .ST_BorderDouble :_gaa =_gf .CellBorderStyleDouble ;default:_gaa =_gf .CellBorderStyleNone ;};var _gdgad _gf .Color ;if _fgefg :=_bdgc .ColorAttr ;_fgefg !=nil {if _abbg :=_fgefg .ST_HexColorRGB ;_abbg !=nil {_gdgad =_gf .ColorRGBFromHex ("\u0023"+*_abbg );};};_degc :=0.0;if _beff :=_bdgc .SzAttr ;_beff !=nil {_degc =float64 (*_beff )/8/_f .Millimeter ;};return _gaa ,&_gdgad ,_degc ;};func (_cgb *convertContext )addAbsoluteCRC (_fdd []*_ae .EG_ContentRunContent ,_aeb *_ae .CT_ParaRPr )bool {for _ ,_efab :=range _fdd {if _ecf :=_efab .R ;_ecf !=nil {_daca :=_eeaa (_cgb ._cea ,_ecf .RPr ,_aeb );if _cgb ._gfde !=""{_cgb .addAbsoluteRIC (nil ,_daca );_cgb ._gfde ="";};for _ ,_def :=range _ecf .EG_RunInnerContent {if _cgb .addAbsoluteRIC (_def ,_daca ){return true ;};};for _ ,_bfcf :=range _ecf .Extra {if _feab ,_cbgc :=_bfcf .(*_ae .AlternateContentRun );_cbgc {if _gacf :=_feab .Choice ;_gacf !=nil {if _baec :=_gacf .Drawing ;_baec !=nil {if len (_baec .Inline )> 0{_cgb .addInlineTextbox (_baec ,_daca );};};};};};};};return false ;};func (_bgae *convertContext )addRelativeEGPC (_fdac []*_ae .EG_PContent ,_dafd *_ae .CT_ParaRPr ){if len (_fdac )==0{_bgae ._ecdg .Append ("\u000d");return ;};for _ ,_eeda :=range _fdac {for _ ,_fgag :=range _eeda .FldSimple {if _fgag !=nil {_bgae .addRelativeEGPC (_fgag .EG_PContent ,_dafd );};};if _ceba :=_eeda .Hyperlink ;_ceba !=nil {_bgae ._egcg =_ceba ;_bgae .addRelativeCRC (_ceba .EG_ContentRunContent ,_dafd );};_bgae ._egcg =nil ;_bgae .addRelativeCRC (_eeda .EG_ContentRunContent ,_dafd );};};const _af =0.67;func (_eeba *convertContext )addRelativeRIC (_dcbf *_ae .EG_RunInnerContent ,_fcda *_ae .CT_RPr ){var _bbbc *_gf .TextChunk ;var _acbe ,_edf bool ;if _dcbf ==nil {if _eeba ._gfde !=""{_acbe =true ;_bbbc =_eeba ._ecdg .Append (_eeba ._gfde );};}else {if _dcbf .T !=nil &&_dcbf .T .Content !=""{_gfbd :=_dcbf .T .Content ;if _gaeb :=_eeba ._egcg ;_gaeb !=nil &&_gaeb .IdAttr !=nil {_bbbc =_eeba ._ecdg .AddExternalLink (_gfbd ,_eeba ._cea .GetTargetByRelId (*_gaeb .IdAttr ));}else {_bbbc =_eeba ._ecdg .Append (_gfbd );};}else if _gbfa :=_dcbf .EndnoteReference ;_gbfa !=nil {_fdae :=_eeba ._cea .BodySection ().X ();_acbe =true ;_bcce :=_gbfa .IdAttr ;_deeg :=_bcce ;_bgfcg :=_ae .ST_NumberFormatLowerRoman ;if _cfa :=_fdae .EndnotePr ;_cfa !=nil {if _gebe :=_cfa .NumFmt ;_gebe !=nil {_bgfcg =_gebe .ValAttr ;};if _ccbe :=_cfa .NumStart ;_ccbe !=nil {_deeg +=_ccbe .ValAttr -1;};};_bbdg :=_dfgb (_deeg ,_bgfcg );_decf :=_eeba ._cea .Endnote (_bcce ).X ();if _decf !=nil {_eeba ._bbdeg =append (_eeba ._bbdeg ,note {_dg :_bbdg ,_ff :_decf .EG_BlockLevelElts });_bbbc =_eeba ._ecdg .Append (_bbdg );};}else if _edgg :=_dcbf .FootnoteReference ;_edgg !=nil {_eggf :=_eeba ._cea .BodySection ().X ();_acbe =true ;_cged :=_edgg .IdAttr ;_gdbd :=_cged ;_gccc :=_ae .ST_NumberFormatDecimal ;if _acdde :=_eggf .FootnotePr ;_acdde !=nil {if _edab :=_acdde .NumFmt ;_edab !=nil {_gccc =_edab .ValAttr ;};if _cdaf :=_acdde .NumStart ;_cdaf !=nil {_gdbd +=_cdaf .ValAttr -1;};};_gfae :=_dfgb (_gdbd ,_gccc );_bbbc =_eeba ._ecdg .Append (_gfae );};};if _bbbc !=nil {_bbbc .Style ,_ ,_ =_eeba .makeRunStyle (_fcda ,_acbe ,_edf ,true );};};